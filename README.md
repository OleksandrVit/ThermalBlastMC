# ThermalBlastMC

## A Blast-Wave–Based Thermal Particle Generator with Hadronic Afterburner

**ThermalBlastMC** is a Monte Carlo event generator for thermal particle production from an expanding relativistic medium, based on the blast-wave model and the Cooper-Frye freeze-out prescription. The generator is designed for event-by-event simulations of hadron emission in relativistic heavy-ion collisions and supports fully differential particle sampling in phase space.

The underlying physics model follows a boost-invariant, cylindrically symmetric freeze-out hypersurface with collective flow and allows for quantum statistics through Fermi-Dirac and Bose-Einstein distribution functions. Particles are generated by sampling both the space-time coordinates of the freeze-out surface and the particle momenta in a way that exactly reproduces the Cooper-Frye formula.

A detailed description of the blast-wave model, assumptions, and formalism can be found in [arXiv:2409.09019](https://arxiv.org/abs/2409.09019).

### Coupling to Hadronic Afterburner

ThermalBlastMC is **directly coupled to the SMASH hadronic transport model**, which provides a microscopic description of the hadronic rescattering and decay stage following hadronization. Generated particles can are passed to SMASH, allowing for a fully consistent simulation of:
- hadronic rescattering,
- particle propagation,
- resonance decays.

In this setup, **the afterburner stage is automatically included**, enabling end-to-end event generation from emission to final-state hadrons.

SMASH is used as a third-party library, and users are expected to cite the corresponding [SMASH reference](https://doi.org/10.1103/PhysRevC.94.054905) when using ThermalBlastMC in scientific publications. See also [SMASH GitHub reposetory](https://github.com/smash-transport/smash/) for more details.  

### Intended Use

ThermalBlastMC is intended for:
- phenomenological studies of soft hadron production,
- testing freeze-out and flow scenarios,
- producing final-state hadrons including hadronic rescattering effects and resonance decay feed-down.
---

## Installation

ThermalBlastMC depends on several external libraries and must be built from source.  
In particular, it requires **SMASH ** with its dependencies and **ROOT**.

### Prerequisites

Before installing ThermalBlastMC, please ensure that the following software is installed and properly configured:

- SMASH and its dependencies
- ROOT
- CMake
- A C++ compiler supporting C++17

### Building ThermalBlastMC

After installing prerequisites, build ThermalBlastMC as follows.  
All commands below must be executed from the **ThermalBlastMC** top-level directory.

1. Copy the SMASH CMake configuration:
```bash
cp -r /path/to/SMASH/cmake .
```
2. Set the environment variable pointing to the SMASH installation directory:
```bash
export SMASH_INSTALL_DIR=/path/to/SMASH/installation
```
3. Create and enter a build directory:
```bash
mkdir build
cd build
```
4. Configure the project with CMake:
```bash
cmake -DPythia_CONFIG_EXECUTABLE=/path/to/Pythia8/bin/pythia8-config ..
```
5. Compile the code:
```bash
make
```
If the build completes successfully, the ThermalBlastMC executable will be created in the ``build`` directory.

### Notes
- The environment variable ``SMASH_INSTALL_DIR`` must point to the SMASH installation prefix.
- Make sure that the ROOT environment is initialized (e.g. by sourcing thisroot.sh) before running CMake.
- This code is tested with SMASH 3.3; newer SMASH versions may require modifications.

---

## Input File Format

ThermalBlastMC uses a YAML input file format that is **based on the standard SMASH input file**.  
Most sections and options are identical to SMASH, with the key difference being the activation of the **BlastWave** mode and the corresponding configuration block.

An example input file is provided in the project directory.

### Example Input File

```yaml
Logging:
    default: INFO

General:
    Modus:          BlastWave
    Time_Step_Mode: None
    Delta_Time:     0.1
    End_Time:       1000.0
    Randomseed:     -1
    Nevents:        10

Output:
    Particles:
        Format: ["Oscar2013"]

Modi:
    BlastWave:
        T: 156.0
        MuB: 0.0
        MuS: 0.0
        MuQ: 0.0
        MuPion: 0.0
        MuKaon: 0.0
        R: 11.5
        v: 0.78
        n: 0.7
        Tau: 8.0
        Max_Eta: 3.0
        Spectral_Function: BW
```
### General Structure

The input file follows the standard SMASH YAML structure.
Compared to a default SMASH input file, ThermalBlastMC requires the following modifications:
1.The ``Modus`` parameter in the ``General`` section must be set to:
```bash
Modus: BlastWave
```
2. A ``BlastWave`` subsection must be provided under the ``Modi`` section.
All other sections (e.g. ``Logging``, ``Output``) follow the standard SMASH conventions.

### BlastWave Parameters

The ``Modi: BlastWave:`` section defines the parameters of the blast-wave freeze-out model.
All parameters listed below are floating-point values, except for ``Spectral_Function``, which is a string.

#### Thermodynamic Parameters
- T - Hadronization (freeze-out) temperature in MeV.
- MuB - Baryon chemical potential in MeV.
- MuS - Strangeness chemical potential in MeV.
- MuQ - Electric charge chemical potential in MeV.
- MuPion - Non-equilibrium pion chemical potential in MeV.
- MuKaon - Non-equilibrium kaon chemical potential in MeV.

#### Geometric and Flow Parameters
- R - Radius of the hadronization hypersurface.
- v - Transverse expansion velocity at the surface.
- n - Exponent of the transverse velocity profile.
- Tau - Proper time of the hadronization (freeze-out) hypersurface.
- Max_Eta - Maximum absolute value of the space-time rapidity window.

#### Spectral Function
``Spectral_Function`` specifies the mass distribution used for resonances.
Allowed values are:
- BW - Breit–Wigner distribution with constant width.
- RBW - Relativistic Breit–Wigner distribution with constant width
- SMASH - Full spectral function as implemented in SMASH.
- None - Constant pole mass (no mass distribution).

## Running ThermalBlastMC

After successfully building the code, ThermalBlastMC can be executed from the command line:
```bash
./ThermalBlastMC <path/to/config/file> <path/to/output/directory>
```
Here:
- ``<path/to/config/file>`` is the path to the YAML input file describing the simulation setup.
- ``<path/to/output/directory>`` is the directory where the output files will be written. If the specified output directory does not exist, it will be created automatically.